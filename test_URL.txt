/**
 * Return status code or error for a given url. Tip: wrap the call around the Google Sheets =isurl() function to make sure that only valid URLs are checked, and the =unique() function to make sure every unique URL is checked only once.
 *
 * @param {url} valid url
 * @return result (status code or error message)
 *
 * @customfunction
 */
function httpstatuscode() {
    var url = "google.com"
    console.log('url : '+url)
    var result = [];
    // trim url to prevent (rare) errors
    url.toString().trim();
    console.log('url trim : '+url)
    // don't break if error, but instead return it as a message, also don't follow redirects
    var options = {
        'muteHttpExceptions': true,
        'followRedirects': false,
    };
    // int - returns status code
    try {
        result.push(UrlFetchApp.fetch(url, options).getResponseCode());
    }
    // string - or returns an error (usually 'DNS error' if domain does not exist)
    catch (error) {
        result.push(error.toString());
    } finally {
        console.log('result : '+result)
        return result;
    }
}
