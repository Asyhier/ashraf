/**
 * Return status code or error for a given url. Tip: wrap the call around the Google Sheets =isurl() function to make sure that only valid URLs are checked, and the =unique() function to make sure every unique URL is checked only once. See https://eikhart.com/blog/google-sheets-http-status-codes for an in-depth explanation.
 *
 * @param {url} valid url
 * @return result (status code or error message)
 *
 * @customfunction
 */
function httpstatuscode(url) {
    var result = [];
    // trim url to prevent (rare) errors
    url.toString().trim();
    // don't break if error, but instead return it as a message, also don't follow redirects
    var options = {
        'muteHttpExceptions': true,
        'followRedirects': true,
    };
    // int - returns status code
    try {
        result.push(UrlFetchApp.fetch(url, options).getResponseCode());
    }
    // string - or returns an error (usually 'DNS error' if domain does not exist)
    catch (error) {
        result.push(error.toString());
    } finally {
        return result;
    }
}